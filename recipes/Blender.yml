app: Blender

ingredients:
  script:
    - BASE_URL="https://download.blender.org/release"
    - BASE_VERSION=$(wget -q "${BASE_URL}" -O - | grep 'Blender[0-9]' | tail -n1 | grep -o -m1 '[[:digit:]\.]\+' | head -n 1)
    - VERSION=$(wget -q "${BASE_URL}/Blender${BASE_VERSION}/" -O - | grep -Po '(?<=href=\"blender-)\d\.\d+(\w?|\.\d)(?=\-linux64\.tar\.xz\")' | tail -n 1)
    - FILENAME=blender-${VERSION}-linux64.tar.xz
    - URL="${BASE_URL}/Blender${BASE_VERSION}/${FILENAME}"
    - echo $VERSION > VERSION
    - wget "$URL"
    - mkdir -p blender
    - tar xf ${FILENAME} -C ./blender --strip-components=1

script:
  - cp -r ../blender/* ./usr/bin/;
  - cp ../blender/blender.svg .
  -
  - cat > blender.desktop <<\EOF
  - [Desktop Entry]
  - Name=Blender
  - GenericName=3D modeler
  - Comment=3D modeling, animation, rendering and post-production
  - Keywords=3d;cg;modeling;animation;painting;sculpting;texturing;video editing;video tracking;rendering;render engine;cycles;game engine;python;
  - Exec=blender %f
  - Icon=blender
  - Terminal=false
  - Type=Application
  - Categories=Graphics;3DGraphics;
  - MimeType=application/x-blender;
  - EOF
